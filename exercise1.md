## Алгоритмы балансировки:


- 1. Round-Robin 
- 2. Weighted Round-Robin
- 3. Least Connections
- 4. Least Respons Time
- 5. Destination Hash Scheduling /Source Hash Scheduling
- 6. Sticky Sessions


---

## Особенности и недостатки


### ___- Round-Robin(ПО-КРУГОВОЙ)___ 

![Изображение](https://wiki.merionet.ru/images/chto-takoe-balansirovka-nagruzki-v-seti/2.png)

Round Robin, или алгоритм кругового обслуживания, представляет собой перебор по круговому циклу: первый запрос передаётся одному серверу, затем следующий запрос передаётся другому и так до достижения последнего сервера, а затем всё начинается сначала.

Самой распространёной имплементацией этого алгоритма является, конечно же, метод балансировки Round Robin DNS. Как известно, любой DNS-сервер хранит пару «имя хоста — IP-адрес» для каждой машины в определённом домене.

DNS-сервер проходит по всем записям таблицы и отдаёт на каждый новый запрос следующий IP-адрес: например, на первый запрос — xxx.xxx.xxx.2, на второй — ххх.ххх.ххх.3, и так далее. В результате все серверы в кластере получают одинаковое количество запросов.

#### Особенности

В числе несомненных плюсов этого алгоритма следует назвать, во-первых, независимость от протокола высокого уровня. Для работы по алгоритму Round Robin используется любой протокол, в котором обращение к серверу идёт по имени.
Балансировка на основе алгоритма Round Robin никак не зависит от нагрузки на сервер: кэширующие DNS-серверы помогут справиться с любым наплывом клиентов.

Использование алгоритма Round Robin не требует связи между серверами, поэтому он может использоваться как для локальной, так и для глобальной балансировки,.
Наконец, решения на базе алгоритма Round Robin отличаются низкой стоимостью: чтобы они начали работать, достаточно просто добавить несколько записей в DNS.

#### Недостатки

Чтобы распределение нагрузки по этому алгоритму отвечало упомянутым выше критериями справедливости и эффективности, нужно, чтобы у каждого сервера был в наличии одинаковый набор ресурсов. При выполнении всех операций также должно быть задействовано одинаковое количество ресурсов. В реальной практике эти условия в большинстве случаев оказываются невыполнимыми.

Также при балансировке по алгоритму Round Robin совершенно не учитывается загруженность того или иного сервера в составе кластера. Представим себе следующую гипотетическую ситуацию: один из узлов загружен на 100%, в то время как другие — всего на 10 — 15%. Алгоритм Round Robin возможности возникновения такой ситуации не учитывает в принципе, поэтому перегруженный узел все равно будет получать запросы. Ни о какой справедливости, эффективности и предсказуемости в таком случае не может быть и речи.

В нём совершенно не учитывается количество активных на данный момент подключений.
В силу описанных выше обстоятельств сфера применения алгоритма Round Robin весьма ограничена.


---

### ___-Weighted Round-Robin___ 

Это — усовершенствованная версия алгоритма Round Robin.


#### Особенности

Суть усовершенствований заключается в следующем: каждому серверу присваивается весовой коэффициент в соответствии с его производительностью и мощностью. Это помогает распределять нагрузку более гибко: серверы с большим весом обрабатывают больше запросов.

#### Недостатки

Однако всех проблем с отказоустойчивостью это отнюдь не решает. Более эффективную балансировку обеспечивают другие методы, в которых при планировании и распределении нагрузки учитывается большее количество параметров.

----

### ___-Least Connections(НАИМЕНЬШЕЕ КОЛИЧЕСТВО ПОДКЛЮЧЕНИЙ)___ 

![Изображение](https://wiki.merionet.ru/images/chto-takoe-balansirovka-nagruzki-v-seti/3.png)

#### Особенности

каждый последующий запрос направляется на сервер с наименьшим количеством поддерживаемых подключений, которое позволяет адекватно распределять нагрузку по серверам с приблизительно одинаковыми параметрами.

#### Недостатки

необходимость балансировки между несколькими Frontend-серверами. Когда пользователь устанавливает соединение с Frontend-сервером, все запросы будут отправляться именно на него. При соблюдении алгоритма Least connections другой Frontend-сервер может быть менее нагружен, и пользователь подключится к нему — ему придется заново авторизоваться. 

Впрочем, данную проблему решает Sticky Sessions. Функция алгоритма состоит в том, что сервер, обработавший запрос, закрепляется для сессии пользователя. Сессия начнется на другом сервере, только если первоначальный сервер будет недоступен.

--- 

### ___-Least Response Time(НАИМЕНЬШЕЕ ВРЕМЯ ОТКЛИКА)___

![Изображение](https://wiki.merionet.ru/images/chto-takoe-balansirovka-nagruzki-v-seti/4.png)

Назначение балансировщиков нагрузки — повысить производительность приложений и снизить нагрузку за счет «эффективного» распределения входящего трафика по группе серверов. Для приложений, ориентированных на пользователя, это приведет к сокращению времени отклика.


#### Особенности

Метод балансировки нагрузки с наименьшим временем отклика увеличивает время доступности серверов.

Он равномерно назначает новые запросы каждому серверу, чтобы предотвратить перегрузку.

#### Недостатки

Поскольку балансировщик нагрузки с наименьшим временем отклика не является детерминированным, устранить неполадки сложно.

Алгоритм балансировщика нагрузки с наименьшим временем отклика сложен и требует дополнительной обработки.

Его производительность зависит от того, насколько хороши оценки времени отклика.

---

### ___-Sticky Sessions(Липкие сессии)___

Один из подходов к высокой масштабируемости - использовать балансировку сетевой нагрузки для разделения нагрузки на обработку между несколькими серверами.

![Изображение](https://wiki.merionet.ru/images/chto-takoe-balansirovka-nagruzki-v-seti/1.png)

#### Особенности

Необходимость использования закрепленных сессий определяется архитектурой вашего приложения. Прикрепленные сеансы являются предпочтительным решением для приложений с отслеживанием состояния , которые не могут позволить себе совместно использовать сеансы на нескольких серверах. Приложения с отслеживанием состояния хранят данные локально или на удаленном сервере. Операция отправки всех необходимых данных сеанса от клиента каждый раз, когда он достигает сервера, может быть дорогостоящей. Прикрепляя сеансы, вы пользуетесь кешированной информацией, вместо того чтобы выполнять одну и ту же дорогостоящую операцию каждый раз, когда клиент делает один и тот же запрос.

#### Недостатки

Одна из проблем, которую представляет этот подход - это где сервера осведомлены о состоянии - хранение состояния пользователя в "сессии".

Одним из вариантов решения этой проблемы является "липкая сессия" (aka "session affinity") где каждому пользователю назначается один-единственный сервер и его/ее данные о состоянии содержатся на том сервере исключительно на протяжении всей продолжительности сессии.

---

### ___-Hash___

Алгоритм хеширования определяет, куда распределять запросы, на основе назначенного ключа, такого как IP-адрес клиента, номер порта или URL-адрес запроса. Метод Hash используется для приложений, которые полагаются на сохраненную информацию о пользователях, например, тележки на веб-сайтах интернет магазинов.


![Изображение](https://wiki.merionet.ru/images/chto-takoe-balansirovka-nagruzki-v-seti/5.png)

#### Особенности
Использует информацию об IP-адресе клиента для выбора сервера. Это может помочь сохранить сессии клиентов на одном сервере и избежать необходимости повторной аутентификации.  

#### Недостатки
Если IP-адрес клиента изменяется (например, при использовании прокси-серверов), то балансировка нагрузки может быть нарушена. Кроме того, этот метод может привести к неравномерному распределению нагрузки, если IP-адресы клиентов не равномерно распределены. 
